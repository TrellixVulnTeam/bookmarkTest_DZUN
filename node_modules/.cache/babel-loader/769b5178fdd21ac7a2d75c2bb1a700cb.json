{"ast":null,"code":"var _jsxFileName = \"/Users/macbook/Documents/myWork/bookmarks-reactjs/src/containers/HandelLink.tsx\",\n    _s = $RefreshSig$();\n\nimport { useContext, useMemo, useState } from 'react';\nimport Submit from '../components/Button';\nimport TagsInput from '../components/TagsInput';\nimport TextField from '../components/TextField';\nimport LinkContext from '../contexts/LinkContext';\nimport useInput from '../hooks/useInput';\nimport { validate, getLinkDetails } from '../utils/link';\nimport classes from './scss/addLink.module.scss';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nconst HandelLink = ({\n  history,\n  match\n}) => {\n  _s();\n\n  const {\n    links,\n    setLinks\n  } = useContext(LinkContext);\n  const {\n    id\n  } = match.params;\n  const {\n    link,\n    index\n  } = useMemo(() => {\n    const index = links.findIndex(l => l.id === Number(id));\n    return {\n      index,\n      link: index !== -1 ? links[index] : null\n    };\n  }, [id, links]);\n  const [linkState, onLinkChange, onLinkBlur, {\n    setTouched: setLinkTouched,\n    setError: setLinkError\n  }] = useInput(link ? link.url : '', validate);\n  const [tags, setTags] = useState(link ? link.tags : []);\n\n  const onSubmit = e => {\n    e.preventDefault();\n\n    if (linkState.error) {\n      setLinkTouched(true);\n    } else {\n      getLinkDetails(linkState.value).then(data => {\n        if (!link) {\n          setLinks([...links, {\n            id: links.length ? links[links.length - 1].id + 1 : 0,\n            url: linkState.value,\n            type: data.type,\n            title: data.title,\n            author: data.author_name,\n            duration: data.duration,\n            height: data.height,\n            width: data.width,\n            createdAt: new Date().toISOString(),\n            tags: tags\n          }]);\n        } else {\n          const nextLinks = [...links];\n          nextLinks[index] = { ...link,\n            tags\n          };\n          setLinks(nextLinks);\n        }\n\n        history.push('/');\n      }).catch(() => {\n        setLinkTouched(true);\n        setLinkError('Impossible de résoudre le lien');\n      });\n    }\n  };\n\n  if (!link && id !== undefined) {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      children: \"404 not found\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 64,\n      columnNumber: 12\n    }, this);\n  }\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: classes.container,\n    children: /*#__PURE__*/_jsxDEV(\"form\", {\n      className: classes.form,\n      onSubmit: onSubmit,\n      children: [/*#__PURE__*/_jsxDEV(TextField, {\n        error: linkState.touched ? linkState.error : '',\n        value: linkState.value,\n        onChange: onLinkChange,\n        onBlur: onLinkBlur,\n        label: 'URL',\n        disabled: !!link\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 70,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(TagsInput, {\n        className: classes.tags,\n        tags: tags,\n        onTagsChange: setTags\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 78,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Submit, {\n        className: classes.submit,\n        children: [link ? 'Modifier lien' : 'Ajouter lien', \" \"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 79,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 69,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 68,\n    columnNumber: 5\n  }, this);\n};\n\n_s(HandelLink, \"iwuM3FxLEwxxuZKhjk4/XmWOCwI=\", false, function () {\n  return [useInput];\n});\n\n_c = HandelLink;\nexport default HandelLink;\n\nvar _c;\n\n$RefreshReg$(_c, \"HandelLink\");","map":{"version":3,"sources":["/Users/macbook/Documents/myWork/bookmarks-reactjs/src/containers/HandelLink.tsx"],"names":["useContext","useMemo","useState","Submit","TagsInput","TextField","LinkContext","useInput","validate","getLinkDetails","classes","HandelLink","history","match","links","setLinks","id","params","link","index","findIndex","l","Number","linkState","onLinkChange","onLinkBlur","setTouched","setLinkTouched","setError","setLinkError","url","tags","setTags","onSubmit","e","preventDefault","error","value","then","data","length","type","title","author","author_name","duration","height","width","createdAt","Date","toISOString","nextLinks","push","catch","undefined","container","form","touched","submit"],"mappings":"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","sourcesContent":["import { useContext, useMemo, useState } from 'react';\nimport { RouteComponentProps } from 'react-router-dom';\nimport Submit from '../components/Button';\nimport TagsInput from '../components/TagsInput';\nimport TextField from '../components/TextField';\nimport LinkContext from '../contexts/LinkContext';\nimport useInput from '../hooks/useInput';\nimport { validate, getLinkDetails } from '../utils/link';\n\nimport classes from './scss/addLink.module.scss';\n\nconst HandelLink = ({ history, match }: RouteComponentProps<{ id?: string }>) => {\n  const { links, setLinks } = useContext(LinkContext);\n  const { id } = match.params;\n  const { link, index } = useMemo(() => {\n    const index = links.findIndex((l) => l.id === Number(id));\n    return { index, link: index !== -1 ? links[index] : null };\n  }, [id, links]);\n\n  const [linkState, onLinkChange, onLinkBlur, { setTouched: setLinkTouched, setError: setLinkError }] = useInput(\n    link ? link.url : '',\n    validate,\n  );\n  const [tags, setTags] = useState(link ? link.tags : []);\n\n  const onSubmit = (e: React.FormEvent<HTMLFormElement>) => {\n    e.preventDefault();\n    if (linkState.error) {\n      setLinkTouched(true);\n    } else {\n      getLinkDetails(linkState.value)\n        .then((data) => {\n          if (!link) {\n            setLinks([\n              ...links,\n              {\n                id: links.length ? links[links.length - 1].id + 1 : 0,\n                url: linkState.value,\n                type: data.type,\n                title: data.title,\n                author: data.author_name,\n                duration: data.duration,\n                height: data.height,\n                width: data.width,\n                createdAt: new Date().toISOString(),\n                tags: tags,\n              },\n            ]);\n          } else {\n            const nextLinks = [...links];\n            nextLinks[index] = { ...link, tags };\n            setLinks(nextLinks);\n          }\n          history.push('/');\n        })\n        .catch(() => {\n          setLinkTouched(true);\n          setLinkError('Impossible de résoudre le lien');\n        });\n    }\n  };\n\n  if (!link && id !== undefined) {\n    return <div>404 not found</div>;\n  }\n\n  return (\n    <div className={classes.container}>\n      <form className={classes.form} onSubmit={onSubmit}>\n        <TextField\n          error={linkState.touched ? linkState.error : ''}\n          value={linkState.value}\n          onChange={onLinkChange}\n          onBlur={onLinkBlur}\n          label={'URL'}\n          disabled={!!link}\n        />\n        <TagsInput className={classes.tags} tags={tags} onTagsChange={setTags} />\n        <Submit className={classes.submit}>{link ? 'Modifier lien' : 'Ajouter lien'} </Submit>\n      </form>\n    </div>\n  );\n};\n\nexport default HandelLink;\n"]},"metadata":{},"sourceType":"module"}